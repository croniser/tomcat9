services:
  tomcat9:
    build:
      context: .
      dockerfile: docker/Dockerfile
      args:
        BUILD_DATE: "${BUILD_DATE}"
        GIT_COMMIT: "${GIT_COMMIT}"
        VERSION: "${VERSION}"
        RESOURCES_DIR: ${RESOURCES_DIR:-docker/resources/}
    image: "${DOCKER_REGISTRY:-docker.io}/${DOCKER_REPO:-gcroniser}/${DOCKER_IMAGE:-tomcat9-jdk21}:${DOCKER_TAG:-latest}"
    container_name: "${DOCKER_IMAGE:-tomcat9-jdk21}"
    environment:
      ENABLE_JPDA: "${ENABLE_JPDA:-false}"
    ports:
      - "${PORT_TOMCAT:-8080}:8080"
      - "${PORT_JPDA:-5005}:5005"
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8080/"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s
